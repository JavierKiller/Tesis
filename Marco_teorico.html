<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>marco_teorico</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Marco_teorico_files/libs/clipboard/clipboard.min.js"></script>
<script src="Marco_teorico_files/libs/quarto-html/quarto.js"></script>
<script src="Marco_teorico_files/libs/quarto-html/popper.min.js"></script>
<script src="Marco_teorico_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Marco_teorico_files/libs/quarto-html/anchor.min.js"></script>
<link href="Marco_teorico_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Marco_teorico_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Marco_teorico_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Marco_teorico_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Marco_teorico_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="marco-teórico" class="level2">
<h2 class="anchored" data-anchor-id="marco-teórico">Marco teórico</h2>
<section id="vigilancia-epidemiológica-y-entomológica-del-dengue" class="level3">
<h3 class="anchored" data-anchor-id="vigilancia-epidemiológica-y-entomológica-del-dengue">Vigilancia Epidemiológica y Entomológica del Dengue</h3>
<p>Las enfermedades transmitidas por vectores (ETV), son padecimientos en los que un artrópodo (mosquitos, chinches, garrapatas, etc.) actúa como agente infeccioso. A este tipo de artrópodos se le denomina “vector” (<span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Este vector actúa como hospedero y/o transmisor de la enfermedad, durante su ciclo de vida tienen diferentes hospederos periodo en el cual adquiere la enfermedad y puede transmitirla a hospederos vertebrados como los humanos (<span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Algunos ejemplos de este tipo de enfermedades son: paludismo, dengue, leishmaniasis, oncocercosis, tripanosomiasis, rickettsiosis, fiebre del oeste del Nilo, fiebre chikungunya, erliquiosis, anaplasmosis y otras arbovirosis (<span class="citation" data-cites="Braks2003">@Braks2003</span>; <span class="citation" data-cites="Kamgang2013">@Kamgang2013</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>).</p>
<p>Las ETV son un problema de salud pública en México, se estima que donde se localiza la mayor parte de centros agrícolas, ganaderos, industriales, pesqueros, petroleros y turísticos, es decir; en cerca del 60 % del territorio nacional, se tienen condiciones ambientales que favorecen su transmisión (<span class="citation" data-cites="Braks2003">@Braks2003</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Entre ellas, el dengue representa una grave amenaza, con brotes recurrentes en diversas regiones del país (<span class="citation" data-cites="Braks2003">@Braks2003</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Para prevenir y controlar eficazmente las enfermedades antes mencionadas, en México existen los programas de vigilancia entomológica y control integral de enfermedades transmitidas por vectores a nivel federal y estatal (<span class="citation" data-cites="Braks2003">@Braks2003</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>).</p>
<section id="vigilancia-epidemiológica" class="level4">
<h4 class="anchored" data-anchor-id="vigilancia-epidemiológica">Vigilancia Epidemiológica:</h4>
<p>La vigilancia epidemiológica del dengue comprende recopilar, analizar y difundir sistemáticamente información sobre la enfermedad. Sus objetivos incluyen la detección temprana de brotes, la medición de la carga de la enfermedad, el seguimiento de las tendencias, la evaluación del impacto social y económico (<span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Weetman2018">@Weetman2018</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Asimismo, ayuda en la asignación de recursos, planificación de acciones preventivas y de contención. Por ello, la vigilancia epidemiológica es esencial para el control y la gestión eficaz contra la enfermedad (<span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Weetman2018">@Weetman2018</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>).</p>
</section>
<section id="índices-estegomía" class="level4">
<h4 class="anchored" data-anchor-id="índices-estegomía">Índices Estegomía</h4>
<p>Para evaluar la presencia y densidad de los mosquitos <em>Aedes</em>, los programas estatales de prevención y control del dengue utilizan los llamados índices de estegomía. Estos índices cuantifican el riesgo entomológico con respecto a criaderos potenciales y criaderos habitados por larvas o pupas del mosquito <em>Aedes</em> a través del muestreo en campo. El muestreo debe ser uniforme en el área de estudio y la unidad de muestreo básica es la casa o localidad (<span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="gobmx2023">@gobmx2023</span>). Al muestrear, el objetivo es observar sistemáticamente contenedores de almacenamiento de agua (<span class="citation" data-cites="TunLin1996">@TunLin1996</span>; <span class="citation" data-cites="Kamgang2010">@Kamgang2010</span>; <span class="citation" data-cites="Kamgang2013">@Kamgang2013</span>; <span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). Los contenedores se examinan para detectar la presencia de larvas y pupas de mosquitos (<span class="citation" data-cites="Garjito2020">@Garjito2020</span>).</p>
<p>La Organización Mundial de la Salud (OMS) (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>) recomienda el uso de los índices estegomía para evaluar la presencia y la densidad de criaderos de mosquitos en las comunidades (<span class="citation" data-cites="Organization2016">@Organization2016</span>). Los índices utilizados son el índice de casa positiva (HI), el índice de contenedor positivo y el índice de Breteau (<span class="citation" data-cites="Organization2016">@Organization2016</span>). En el estado de Sonora el “Programa de Acción Específico de Enfermedades Transmitidas por Vector” (PAE-ETV) usa estos índices para ayudar a determinar las acciones que mitigan el riesgo entomológico (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). A continuación, se presentan los índices de estegomía empleados por el PAE-ETV (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
<section id="índice-de-casa-positiva-hi" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="índice-de-casa-positiva-hi">Índice de casa positiva (HI)</h5>
<p>El índice de casa positiva (HI) es definido como la proporción de casas infestadas con larvas o pupas. La OMS (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>) recomienda usar la siguiente expresión para su cálculo <span class="citation" data-cites="Quintero2015 Praptowibowo2015 Garjito2020 Tedjou2020 Tomia2022">[@Quintero2015; @Praptowibowo2015; @Garjito2020; @Tedjou2020; @Tomia2022]</span>.</p>
<p><span id="eq-hi-index"><span class="math display">\[         
  HI = \frac{
   \text{Número de casas infestadas}
  }{
    \text{Número de casas inspeccionadas}
  } \times 100
. \tag{1}\]</span></span></p>
<p>En Sonora el PAE-ETV utiliza este índice HI para monitorear la infestación de casas; además, permite evaluar la presencia, y estimar la distribución del mosquito (<span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). Este índice considera a las casas como unidad de observación, no toma en cuenta la cantidad de contenedores positivos ni la productividad de esos contenedores (<span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>).</p>
<p>El índice de casa positiva se ha utilizado ampliamente para monitorear los niveles de infestación, pero no toma en cuenta la cantidad de contenedores positivos ni la productividad de esos contenedores (<span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>).</p>
<p>Dentro de un área determinada, el cálculo de este índice asume la misma probabilidad de transmisión del virus. De esta manera, si calculamos el índice HI en una muestra de un sector se puede inferir para todo el sector (<span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). La OMS considera el riesgo entomológico en emergencia cuando al menos uno de los índices de estegomía es igual o mayor a 5 (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
</section>
<section id="índice-de-contenedor-positivo-ci" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="índice-de-contenedor-positivo-ci">Índice de contenedor positivo (CI)</h5>
<p>El índice de contenedor positivo (CI) se define como la proporción de contenedores con presencia de larvas o pupas de mosquito en relación con todos los contenedores que tienen agua (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). A continuación, se muestra la siguiente expresión para su cálculo (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>).</p>
<p><span id="eq-ci-index"><span class="math display">\[         
  CI = \frac{
   \text{Número de contenedores infestados}
  }{
    \text{Número de contenedores inspeccionados}
  } \times 100
\tag{2}\]</span></span></p>
<p>El índice CI es útil para conocer la proporción de contenedores con agua que tienen larvas o pupas de mosquito, y permite estimar el riesgo en el área estudiada (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). Este índice ayuda a evaluar la densidad de criaderos en la zona, proporcionando información para identificar las áreas con mayor riesgo de infestación (<span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>). Por lo tanto, en caso de que el índice CI sea bajo y el HI sea alto, se infiere que el riesgo es mínimo por cada casa muestreada, pero está muy disperso entre las casas del área muestreada; lo cual sugiere realizar acciones de control y prevención en toda el área de estudio (sector, colonia o localidad) (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
<p>El clasificar el tipo de contenedor permite elegir la estrategia específica para las condiciones particulares del área de estudio, como puede ser aplicar control físico para mantener bajo control o eliminar criaderos potenciales, dependiendo de la cantidad y el tamaño se puede solo tirar a la basura u organizar campañas de eliminación o descacharre de ser necesario (<span class="citation" data-cites="Organization2016">@Organization2016</span>). Otra estrategia sería el uso de químicos larvicidas como apoyo al control físico (<span class="citation" data-cites="Kamgang2010">@Kamgang2010</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
<p>En caso de que índice CI sea alto y el HI sea bajo, esto indica que el riesgo está concentrado en pocas casas infestadas, por lo que se pueden enfocar las acciones en esa zona específica (<span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>). Los índices son complementarios y se necesitan ambos para identificar correctamente el riesgo entomológico y tomar medidas efectivas para combatirlo (<span class="citation" data-cites="TunLin1996">@TunLin1996</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
</section>
<section id="índice-de-breteau-bi" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="índice-de-breteau-bi">Índice de Breteau (BI)</h5>
<p>El índice Breteau (BI) describe número de recipientes positivos por cada 100 casas inspeccionadas (<span class="citation" data-cites="TunLin1996">@TunLin1996</span>; <span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>).</p>
<p><span id="eq-bi-index"><span class="math display">\[         
  BI = \frac{
   \text{Número de contenedores infestados}
  }{
    \text{Número de casas inspeccionadas}
  } \times 100
\tag{3}\]</span></span></p>
<p>El BI proporciona una relación directa entre la cantidad de recipientes positivos y el número de casas inspeccionadas. Cuando los contenedores positivos tienden a ser uno por casa positiva el BI tendrá un valor igual al HI (<span class="citation" data-cites="TunLin1996">@TunLin1996</span>; <span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Quintero2015">@Quintero2015</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>). En el caso que el BI salga alto pese a que los otros dos índices sean bajos, indica una alta concentración de recipientes por casa, aunque la proporción de casas positivas sea baja y la proporción de recipientes positivos también sea baja, en este caso el riesgo es que más recipientes (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>; <span class="citation" data-cites="Tomia2022">@Tomia2022</span>). El BI evalúa la distribución espacial de los criaderos y sirve para orientar las acciones de control y prevención. Sin embargo, no refleja la productividad de los contenedores, lo que limita su capacidad para proporcionar una evaluación completa del riesgo de transmisión del virus. Estos datos son particularmente relevantes para centrar esfuerzos para la gestión o eliminación de los hábitats más comunes y para la orientación de mensajes educativos en apoyo de iniciativas comunitarias (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Bowman2014">@Bowman2014</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). La vigilancia epidemiológica y entomológica ayudan a dirigir las acciones necesarias para la prevención y control de ETVs como el dengue. Mediante la recopilación sistemática de datos sobre la enfermedad y los vectores, se pueden tomar decisiones informadas para mitigar su impacto y proteger a la población (<span class="citation" data-cites="TunLin1996">@TunLin1996</span>; <span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Praptowibowo2015">@Praptowibowo2015</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>). Los índices de estegomía son indispensables para la vigilancia y el control del dengue proporcionando información valiosa para evaluar el riesgo de transmisión, y permiten la toma de decisiones estratégicas para priorizar acciones y monitorear la efectividad de las intervenciones, para prevenir la transmisión del dengue y proteger la salud de la población (<span class="citation" data-cites="SouthEastAsia2011">@SouthEastAsia2011</span>; <span class="citation" data-cites="Organization2016">@Organization2016</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>; <span class="citation" data-cites="Tedjou2020">@Tedjou2020</span>).</p>
</section>
</section>
</section>
<section id="programa-de-acción-específico-de-enfermedades-transmitidas-por-vector" class="level3">
<h3 class="anchored" data-anchor-id="programa-de-acción-específico-de-enfermedades-transmitidas-por-vector">Programa de Acción Específico de Enfermedades Transmitidas por Vector</h3>
<p>El Programa de Acción Específico de Enfermedades Transmitidas por Vector”(PAE- ETV), realiza diversas actividades para la prevención y control de ETV (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Estas actividades se pueden dividir en dos grupos: las de vigilancia entomológicas y las de prevención y control (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). El objetivo de todas estas acciones es prevenir y controlar brotes de enfermedades transmitidas por vectores (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Las ETV son aquellas causadas por un agente vivo, como los insectos que ingieren microorganismos de la sangre que consumen de otros seres vivos y después los transmiten mediante sus picaduras (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
<p>::: {#tbl-tabla-v} {.striped .hover}</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Actividades</th>
<th>Abreviatura</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vigilancia entomológica con ovitrampas</td>
<td>OV</td>
<td>Las ovitrampas son contenedores con atributos ideales para que los mosquitos utilicen como criadero; de esta forma, el personal del Programa de Vectores se encarga de revisar, colectar y contabilizar los huevecillos de los mosquitos y realizar una comparación de la densidad.</td>
</tr>
<tr class="even">
<td>Estudios entomológicos en fase larval y pupal</td>
<td>EE</td>
<td>Búsqueda de criaderos con larvas o pupas de mosquitos dentro de las casas de una zona a trabajar, se realiza una búsqueda previa a las acciones de control de ETV y una búsqueda posterior cuando el área ya ha sido intervenida por las acciones de prevención y control.</td>
</tr>
<tr class="odd">
<td>Estudios Entomovirológicos</td>
<td>EEV</td>
<td>Colecta de mosquitos adultos dentro de viviendas para identificar las especies transmisoras de ETV, asimismo para el análisis por PCR de los mosquitos buscando encontrar ETV circulando en las áreas antes de que se reporten casos en personas.</td>
</tr>
</tbody>
</table>
<p>Actividades de prevención y control</p>
<p>:::</p>
<div id="tbl-tabla-1.2" class="striped hover quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabla-1.2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Actividades de prevención y control
</figcaption>
<div aria-describedby="tbl-tabla-1.2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Actividades</th>
<th>Abreviatura</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Control Larvario</td>
<td>CL</td>
<td>Búsqueda intencionada de criaderos potenciales de mosquitos de un área determinada para la aplicación de medidas de prevención, en todas las casas que permitan la entrada.</td>
</tr>
<tr class="even">
<td>Rociado a caso probable</td>
<td>RaC</td>
<td>Aplicación intradomiciliar de insecticida con efecto residual en casas dentro de un cerco de 5 a 9 casas en respuesta a un caso probable o confirmado a Dengue, Zika o Chicungunya.</td>
</tr>
<tr class="odd">
<td>Rociado intradomiciliario</td>
<td>RI</td>
<td>Aplicación intradomiciliar de insecticida con efecto residual en casas de un área que se considere de riesgo entomológico y susceptible a contagios de ETV.</td>
</tr>
<tr class="even">
<td>Nebulización espacial</td>
<td>N</td>
<td>Aplicación de rociado espacial de insecticidas sin efecto residual en un área con alto riesgo entomológico o en respuesta a casos probables o confirmados.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="plataforma-de-vigilancia-entomológica-y-control-integral-del-vector" class="level4">
<h4 class="anchored" data-anchor-id="plataforma-de-vigilancia-entomológica-y-control-integral-del-vector">Plataforma de Vigilancia Entomológica y Control Integral del Vector</h4>
<p>El Programa de Acción Específico de Enfermedades Transmitidas por Vector (PAE-ETV) registra diariamente en una plataforma todas las actividades mencionadas en las tablas <span class="citation" data-cites="ref">@ref</span>(tbl-tabla-1.1) y Tabla <span class="citation" data-cites="ref">@ref</span>(tbl-tabla-1.2) (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Esto permite al programa estatal descargar y analizar los datos. Para la actividad de EE, el programa calcula los resultados por área trabajada y requiere el reporte semanal con base en la ubicación, como se observa en la Tabla <span class="citation" data-cites="ref">@ref</span>(tbl-tabla-1.2) y el sistema integral de vigilancia de vectores (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). La actividad de EE implica el muestreo de formas inmaduras de los mosquitos (las larvas y las pupas) en lugar de capturar huevos o mosquitos adultos (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Se realizan búsquedas sistemáticas para detectar recipientes que contengan agua e inspeccionar la presencia de larvas y pupas de mosquitos (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Esta actividad evalúa una muestra antes (encuesta) y después (verificación) de las actividades de control integral para determinar el riesgo entomológico en un área trabajada (sectores o localidades) y si es necesario reforzar las acciones de control, ver Tabla <span class="citation" data-cites="ref">@ref</span>(tbl-tabla-1.1) y Tabla <span class="citation" data-cites="ref">@ref</span>(tbl-tabla-1.2). (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="Garjito2020">@Garjito2020</span>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/plataforma.gif" class="img-fluid figure-img"></p>
<figcaption>Figura 1.1: Plataforma de Vigilancia Entomológica y Control Integral del Vector</figcaption>
</figure>
</div>
</section>
<section id="datos-geográficos" class="level4">
<h4 class="anchored" data-anchor-id="datos-geográficos">Datos Geográficos</h4>
<p>El PAE-ETV proporcionó shapefiles del estado de Sonora, los cuales se encuentran divididos en sectores (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Con base en ellos se hace la distribución de todas las actividades del PAE-ETV y se usan para poder georreferenciar las áreas intervenidas, determinar el riesgo entomológico y planear las actividades de control y prevención que se requieran (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Los shapefiles pueden usarse para crear mapas con los índices de estegomía específicos en tiempo y lugar según se necesite (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
</section>
</section>
<section id="creación-de-un-paquete-de-r-con-desarrollo-basado-en-pruebas-tdd" class="level3">
<h3 class="anchored" data-anchor-id="creación-de-un-paquete-de-r-con-desarrollo-basado-en-pruebas-tdd">Creación de un paquete de R con desarrollo basado en pruebas (TDD)</h3>
<p>Para determinar el riesgo entomológico delimitado por área geográfica (desde un sector específico o hasta una localidad o municipio) (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Es necesario obtener la información de la vigilancia entomología de forma periódica y comprender la estructura de la base de datos de EE (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Por lo cual, se implementaron herramientas de ciencias de datos para aplicar una metodología en la gestión y análisis de esta información (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Esto implicaría calcular los índices de estegomía para un lugar y un tiempo determinado, para la toma de decisiones (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Este trabajo presenta el desarrollo de un paquete R para el análisis de los datos de vigilancia entomológica del dengue, siguiendo una metodología de desarrollo basado en pruebas (TDD) (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). El paquete combina la potencia de Tidyverse para la manipulación de datos, Devtools para la gestión de Testthat para la escritura de pruebas unitarias (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p>
<p>El desarrollo de software en R ha evolucionado hacia metodologías más sofistica- das y automatizadas (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). El uso combinado de frameworks como Tidyverse, Devtools y Testthat permite crear un trabajo con desarrollo basado en pruebas (TDD) para proyectos de R (ver Figura 1.1) (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Tidyverse es una colección de paquetes R enfocados en la manipulación de datos, análisis estadístico y visualización (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Su filosofía funcional facilita la escritura de código modular y limpio (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Devtools es un paquete R indispensable para la gestión de proyectos, creación de paquetes y publicación en CRAN. Automatiza tareas comunes como la ejecución de pruebas y generación de documentación. Testthat es un paquete R crucial para implementar TDD (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Permite escribir pruebas unitarias que garantizan el funcionamiento correcto de cada función o módulo del código (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/TDD.jpg" class="img-fluid figure-img"></p>
<figcaption>figura1.2</figcaption>
</figure>
</div>
<p>Figura 1.2: Diagrama del Paradigma TDD</p>
<ul>
<li><p>El desarrollo basado en pruebas (TDD): es una metodología de creación de software en la que se escriben pruebas antes de escribir el código (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Esto ayuda a garantizar que el código esté bien escrito y cumpla con los requisitos (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
<li><p>Escribir pruebas: se definen pruebas unitarias para cada función utilizando Testthat (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
<li><p>Desarrollar código: se implementa el código que satisface las pruebas escritas (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
<li><p>Ejecutar pruebas: se ejecutan las pruebas para verificar el funcionamiento del código (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
<li><p>Refactorizar: se mejora la legibilidad y mantenimiento del código sin alterar su funcionalidad (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
<li><p>Repetir: se repiten los pasos anteriores hasta completar el desarrollo (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p></li>
</ul>
<p>Combinar Tidyverse, Devtools y Testthat en un flujo de trabajo TDD es una práctica recomendada para el desarrollo de software en R (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Esta metodología permite tener menos errores, crear un código más robusto, legible y eficiente, facilitando la colaboración y el mantenimiento a largo plazo de los proyectos (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p>
<p>El paquete de R del presente trabajo constituye una valiosa herramienta para la vigilancia entomológica del dengue (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>). Su uso puede contribuir a mejorar la toma de decisiones en materia de prevención y control de la enfermedad, fortaleciendo las estrategias de Salud Pública en México (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>).</p>
</section>
<section id="limpieza-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="limpieza-de-datos">Limpieza de datos</h3>
<p>Los datos para calcular índices de riesgo entomológico son de las actividades de vigilancia entomológica con ovitrampas y estudios entomológicos para fase larvaria y pupal (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Estos datos se descargan de la plataforma en archivos .txt y requieren de un tratamiento previo, que incluye un código particular para leer el tipo de archivo, selección de variables de interés, cambiar el formato de los títulos de las variables y cambios en los tipos de datos, antes de poder realizar cálculos y análisis (<span class="citation" data-cites="rpkgs2023">@rpkgs2023</span>; <span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
<p>La base de datos de EE se descarga en un archivo .txt de la Plataforma “Vigilancia Entomológica y Control Integral del Vector”, tiene 121 variables de las cuales consideramos 16 de interés, tres de ellas se dividen en dos por lo que resultan en 19 variables de interés (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).En general el título de las variables tiene un problema para leerse por ello se cambió los espacios entre palabras por un guion bajo (_) en los títulos de cada variable (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Este formato requiere ajustes para leerlo en el programa de R (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Además, hay inconsistencia en el tipo de dato de algunas variables de interés por lo que se crea una función para cambiarlas al formato adecuado que le corresponde a cada una para poder trabajar con dicha información (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
<section id="variable-para-determinar-el-tipo-de-estudio-entomológico" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="variable-para-determinar-el-tipo-de-estudio-entomológico">Variable para determinar el tipo de Estudio Entomológico</h4>
<p>“Tipo de Estudio” es el nombre de una variable que divide todos los datos de esta actividad en 2 tipos, el primer tipo es “encuesta” que significa que los datos se tomaron antes de realizar acciones de “control larvario (CL)” en el área donde se hizo el estudio entomológico (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). El segundo tipo es “verificación” que indica que los datos de ese EE se hicieron después de realizar acciones de CL (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). De tal manera se pueden comparar los datos antes y después en un área determinada y evaluar si las intervenciones del PAE-ETV han mitigado el riesgo entomológico o si es necesario realizar más acciones (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
</section>
<section id="variable-para-la-georreferenciación" class="level4">
<h4 class="anchored" data-anchor-id="variable-para-la-georreferenciación">Variable para la georreferenciación}</h4>
<p>Las variables para la georreferenciación son las que se utilizan para determinar un lugar en el espacio donde se calcula un riesgo entomológico (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="moraga2023">@moraga2023</span>) a estas variables se les asignó el formato de carácter para su uso adecuado (<span class="citation" data-cites="moraga2023">@moraga2023</span>). Se escogieron estas cuatro variables: “Jurisdicción”, “Municipio”, “Localidad” y “Sector”; cada una es parte de la anterior. El estado de Sonora está dividido en seis jurisdicciones (ahora llamados distritos) y cada jurisdicción tiene determinados municipios que la conforman; a su vez cada municipio tiene localidades que pueden ser desde ciudades a ejidos. En el caso de sectores cuanto más grande la localidad como una ciudad puede tener hasta cientos de sectores que la conformen, pero cuando son lugares pequeños como un pueblo o ejido tienen pocos sectores (de uno a 15). Los sectores corresponden a un formato de división geográfica que usa el Instituto Nacional Electoral (INE) (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="moraga2023">@moraga2023</span>). Las primeras tres variables antes mencionadas tienen un número antes del nombre que corresponde al lugar (qué número de jurisdicción es, qué número de municipio es y qué número de localidad es, respectivamente); para evitar confusiones en la selección de datos geográficos separamos este número del resto del nombre y lo colocamos en variables independientes, estas tres nuevas variables son: “Clave_Jurisdiccion”, “Clave_Municipio” y “Clave_Localidad” (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="moraga2023">@moraga2023</span>).</p>
</section>
<section id="variables-de-intervalos-de-tiempo" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="variables-de-intervalos-de-tiempo">Variables de intervalos de tiempo</h4>
<p>Se seleccionaron dos variables para elegir el tiempo, la primera es “Fecha de Inicio” la cual viene en formato de caracter y se cambia a Tipo de dato POSIX para poder usarla como fecha. Esta es la fecha en que se realiza el EE y se puede comparar entre lugares o en el mismo lugar en diferentes tiempos o en tiempos cercanos en el mismo lugar con diferente tipo de estudio. La segunda variable es Semana Epidemiológica la cual se usa de forma preestablecida, en la Secretaría de Salud y el PAE-ETV reporta usando como unidad de tiempo el número de semana epidemiológica (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
</section>
<section id="variables-para-índices-de-estegomía" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="variables-para-índices-de-estegomía">Variables para índices de estegomía</h4>
<p>Para calcular los índices de estegomía se utilizan seis variables (o las primeras cuatro solamente). Las variables de Casas Revisadas y Casas Positivas se utilizan para calcular el HI. El Total de Recipientes con Agua, y Total de Recipientes Positivos se utilizan para calcular el CI. El Total de Recipientes Positivos a Pupas, y No.&nbsp;Total, de Pupas en Recipientes, se utilizan para calcular índices de contenedor positiva a pupa, porcentaje de pupas en los contenedores positivos (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Otras variables de interés son la tipología de recipiente positivo que consiste en clasificar en tres grupos diferentes a los contenedores según la estrategia de control que se ejecuta en dicho contenedor (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>). Estas tres variables son: Recipientes Tratables, Recipientes Controlables y Recipientes Eliminables. Cuando se determina un riesgo entomológico alto se realiza un análisis de la tipología de contenedor para escoger la estrategia a emplear (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>).</p>
</section>
<section id="georreferenciación-de-las-actividades" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="georreferenciación-de-las-actividades">Georreferenciación de las actividades</h4>
<p>Para poder georreferenciar los indicadores de EE en un mapa se utilizan los datos de Sector para definir en un mapa del estado de Sonora, esto se realiza con un archivo shapefile que contiene todos los sectores del estado de Sonora, este archivo fue proporcionado por el PAE-ETV (<span class="citation" data-cites="Vigilanciaentomologica2019">@Vigilanciaentomologica2019</span>; <span class="citation" data-cites="moraga2023">@moraga2023</span>).</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>